<!doctype html>
<html lang="ch">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="title_topics"></title>

  <!-- Core -->
  <link rel="stylesheet" href="/assets/css/dashboard-core.css">
  <link rel="stylesheet" href="/assets/css/test-core.css">
  

 
  <style>
    .brand svg {
      width: 30px !important;
      height: 30px !important;
    }

    /* --- Light chip UI --- */
    #topicContainer {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }

    .topic-chip {
      padding: 10px 16px;
      border-radius: 18px;
      background: var(--card);
      border: 1px solid var(--line);
      cursor: pointer;
      font-size: 15px;
      user-select: none;
      transition: 0.15s ease;
    }

    .topic-chip:hover {
      background: rgba(0,0,0,0.04);
    }

    .topic-chip.active {
      background: var(--brand);
      color: #fff;
      border-color: var(--brand);
    }

    #startBtn {
      margin-top: 20px;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 10px;
      background: var(--brand);
      color: #fff;
      border: none;
      cursor: pointer;
      display: none; /* shown only after selection */
    }
	.topic-chip.mastered {
  background: #e0ffe4;
  border-color: #34c759;
  color: #0a7a2a;
}
  </style>
        <script>
  document.documentElement.classList.add("i18n-hidden");
</script>
 <script type="module" src="/assets/js/auth-guard.js"></script>
</head>

<body class="test-page">

<button class="menu-toggle" aria-label="Menu">â˜°</button>

<div class="wrap">

  <!-- SIDEBAR -->
  <aside class="sidebar">
<div class="brand">
  CivicLearnÂ®
  <svg viewBox="0 0 32 32" width="30" height="30"
       style="margin-left:6px;vertical-align:middle;border-radius:3px;overflow:hidden;">
    <path d="M0 0h32v32H0z" fill="#f00"/>
    <path d="M13 6h6v7h7v6h-7v7h-6v-7H6v-6h7z" fill="#fff"/>
  </svg>
</div>

              <nav class="nav">
  <a href="index.html"  data-i18n="nav_dashboard"></a>
  <a href="essentiel.html" class="sub active" data-i18n="nav_essential"></a>
  <a href="simulation.html" data-i18n="nav_simulation"></a>
  <a href="quick.html" data-i18n="nav_quick"></a>
  <a href="topics.html"  data-i18n="nav_topics"></a>
  <a href="traps.html" data-i18n="nav_traps"></a>
  <a href="flashcards.html" data-i18n="nav_flashcards"></a>
  <a href="history.html" data-i18n="nav_history"></a>
  <a href="help.html" data-i18n="nav_help"></a>
  <a href="#" data-i18n="nav_logout" id="logoutLink"></a>
</nav>

    <div class="spacer"></div>

<div class="profile">
  <div class="profile-info">
    <div class="reading-inline">
      <span data-i18n="reading_label"></span>
      <button id="readingToggle"
              class="reading-btn inline"
              data-i18n="reading_tooltip"
              data-i18n-attr="title">ðŸ”‡</button>
    </div>
  </div>
</div>
  </aside>

  <!-- OVERLAY -->
  <div class="overlay" id="menuOverlay"></div>

  <!-- MAIN -->
  <main class="main">

    <header class="ce-header ce-header-top">
      <h1 data-i18n="test_essential_title"></h1>
    </header>

<div class="quiz-container" id="quizArea">
	<div class="ce-progress-global">
  <div class="ce-progress-global-bar" id="topicsProgress"></div>
</div>
  <div id="quiz"></div>
</div>

    <section style="display:none;">

      <div id="topicContainer"></div>

      <button id="startBtn" data-i18n="topics_start_btn"></button>

    </section>
  </main>
</div>

<!-- CONFIG + I18N -->
<script src="/assets/js/config-geneva.js"></script>
<script src="/assets/js/i18n.js"></script>
<script>
  CivicLearnI18n.init();
</script>

<!-- READING (must come BEFORE engine.js) -->
<script src="/assets/js/reading.js"></script>

<!-- ENGINE -->
<script src="/assets/js/engine.js"></script>

<!-- MAIN TOPICS LOGIC -->
<script>
function startEssentialTest() {
  const cfg = window.CIVICEDGE_CONFIG || {};
  const limit = (cfg.topics && cfg.topics.questionCount) ? cfg.topics.questionCount : 10;
  const forcedTopics = ["questions-essentielles"];

  // Ensure quiz container exists
  const quizArea = document.getElementById("quizArea") || document.body;
  let quiz = document.getElementById("quiz");
  if (!quiz) {
    quiz = document.createElement("div");
    quiz.id = "quiz";
    quizArea.appendChild(quiz);
  }

  // Start test on the single forced topic
  CivicEdgeEngine.start("topics", {
    topics: forcedTopics,
    limit: limit
  });

  // Re-apply translations on newly inserted nodes
  if (window.CivicLearnI18n && typeof CivicLearnI18n.apply === "function") {
    CivicLearnI18n.apply();
  }

  window.scrollTo({ top: 0, behavior: "smooth" });
}

document.addEventListener("DOMContentLoaded", () => {
  function waitForI18nReady() {
    const root = document.documentElement;
    const i18nReady = !root.classList.contains("i18n-hidden");

    if (i18nReady && window.CivicEdgeEngine) {
      startEssentialTest();
    } else {
      setTimeout(waitForI18nReady, 50);
    }
  }

  waitForI18nReady();
});
</script>




<!-- Menu -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggle = document.querySelector(".menu-toggle");
  const overlay = document.getElementById("menuOverlay");

  toggle.addEventListener("click", () => {
    document.body.classList.toggle("menu-open");
  });
  overlay.addEventListener("click", () => {
    document.body.classList.remove("menu-open");
  });
});
</script>
<script src="/assets/js/signout.js"></script>
</body>
</html>
